{"visual":{"name":"DumbbellChartByMAQSoftware","displayName":"Dumbbell Chart by MAQ Software","guid":"DumbbellChartB13A88DFEE724350B46BCF0EFA5B6E321","visualClassName":"DumbbellChart","version":"3.0.4","description":"Dumbbell Chart displays critical business measures and shows changes over a set duration or across various categories.","supportUrl":"https://github.com/maqsoftware/PowerBI-visuals/issues","gitHubUrl":"https://github.com/maqsoftware/PowerBI-visuals/"},"apiVersion":"1.8.0","author":{"name":"MAQ Software","email":"support@maqsoftware.com"},"assets":{"icon":"assets/icon.png"},"externalJS":["node_modules/powerbi-visuals-utils-dataviewutils/lib/index.js"],"style":"style/visual.less","capabilities":{"dataRoles":[{"displayName":"Category","kind":"Grouping","name":"Category"},{"displayName":"Measure","kind":"Measure","name":"Value"}],"dataViewMappings":[{"conditions":[{"Category":{"max":1},"Value":{"max":4}}],"scriptResult":{"dataInput":{"table":{"rows":{"select":[{"for":{"in":"Category"}},{"for":{"in":"Value"}}],"dataReductionAlgorithm":{"top":{"count":300}}}}},"script":{"scriptProviderDefault":"R","scriptOutputType":"html","source":{"objectName":"rcv_script","propertyName":"source"},"provider":{"objectName":"rcv_script","propertyName":"provider"},"scriptSourceDefault":"# Copyright (c) MAQ Software.  All rights reserved.\r\n\r\n# Third Party Programs. This software enables you to obtain software applications from other sources.\r\n# Those applications are offered and distributed by third parties under their own license terms.\r\n# MAQ Software is not developing, distributing or licensing those applications to you, but instead,\r\n# as a convenience, enables you to use this software to obtain those applications directly from\r\n# the application providers.\r\n# By using the software, you acknowledge and agree that you are obtaining the applications directly\r\n# from the third party providers and under separate license terms, and that it is your responsibility to locate,\r\n# understand and comply with those license terms.\r\n# Microsoft grants you no license rights for third-party software or applications that is obtained using this software.\r\n\r\n#\r\n# WARNINGS:\r\n#\r\n# CREATION DATE: 06/12/2017\r\n#\r\n# LAST UPDATE: --/--/---\r\n#\r\n# VERSION: 3.0.0\r\n#\r\n# R VERSION TESTED: 3.4.2\r\n#\r\n# AUTHOR: MAQ Software\r\n\r\n\r\n\r\n############### Utility functions ###############\r\nlibraryRequireInstall = function(packageName, ...)\r\n{\r\n  if(!require(packageName, character.only = TRUE)) \r\n    warning(paste(\"*** The package: '\", packageName, \"' was not installed ***\", sep=\"\"))\r\n}\r\n\r\nlibraryRequireInstall(\"XML\")\r\nlibraryRequireInstall(\"htmlwidgets\")\r\n\r\ninternalSaveWidget <- function(widget, fname)\r\n{\r\n  tempFname = paste(fname, \".tmp\", sep=\"\")\r\n  htmlwidgets::saveWidget(widget, file = tempFname, selfcontained = FALSE)\r\n  FlattenHTML(tempFname, fname)\r\n}\r\n\r\nFlattenHTML <- function(fnameIn, fnameOut)\r\n{\r\n  # Read and parse HTML file\r\n  # Embed all js and css files into one unified file\r\n  \r\n  if(!file.exists(fnameIn))\r\n    return(FALSE)\r\n  \r\n  dir = dirname(fnameIn)\r\n  html = htmlTreeParse(fnameIn, useInternal = TRUE)\r\n  top = xmlRoot(html)\r\n  \r\n  # extract all <script> tags with src value\r\n  srcNode=getNodeSet(top, '//script[@src]')\r\n  for (node in srcNode)\r\n  {\r\n    b = xmlAttrs(node)\r\n    fname = file.path(dir, b['src'])\r\n    alternateSrc = FindSrcReplacement(fname)\r\n    if (!is.null(alternateSrc))\r\n    {\r\n      s = alternateSrc\r\n      names(s) = 'src'\r\n      newNode = xmlNode(\"script\",attrs = s)\r\n      replaceNodes(node, newNode)\r\n    }else{\r\n      str=ReadFileForEmbedding(fname);\r\n      if (!is.null(str))\r\n      {      \r\n        newNode = xmlNode(\"script\", str, attrs = c(type = \"text/javascript\"))\r\n        replaceNodes(node, newNode)\r\n      }\r\n    }\r\n  }\r\n  \r\n  # extract all <link> tags with src value\r\n  linkNode=getNodeSet(top, '//link[@href]')\r\n  for (node in linkNode)\r\n  {\r\n    b = xmlAttrs(node)\r\n    fname = file.path(dir, b['href'])\r\n    str = ReadFileForEmbedding(fname, FALSE);\r\n    if (!is.null(str))\r\n    {\r\n      newNode = xmlNode(\"style\", str)\r\n      replaceNodes(node, newNode)\r\n    }\r\n  }\r\n  \r\n  saveXML(html, file = fnameOut)\r\n  return(TRUE)\r\n}\r\n\r\nReadFileForEmbedding <- function(fname, addCdata = TRUE)\r\n{\r\n  data = ReadFullFile(fname)\r\n  if (is.null(data))\r\n    return(NULL)\r\n\r\n  str = paste(data, collapse ='\\n')\r\n  if (addCdata) {\r\n    str = paste(cbind('// <![CDATA[', str,'// ]]>'), collapse ='\\n')\r\n  }\r\n  return(str)\r\n}\r\n\r\nReadFullFile <- function(fname)\r\n{\r\n  if(!file.exists(fname))\r\n    return(NULL)\r\n  \r\n  con = file(fname, open = \"r\")\r\n  data = readLines(con)\r\n  close(con)\r\n  return(data)\r\n}\r\n\r\nFindSrcReplacement <- function(str)\r\n{\r\n  # finds reference to 'plotly' js and replaces with a version from CDN\r\n  # This allows the HTML to be smaller, since this script is not fully embedded in it\r\n  str <- iconv(str, to=\"UTF-8\")\r\n  pattern = \"plotlyjs-(\\\\w.+)/plotly-latest.min.js\"\r\n  match1=regexpr(pattern, str)\r\n  attr(match1, 'useBytes') <- FALSE\r\n  strMatch=regmatches(str, match1, invert = FALSE)\r\n  if (length(strMatch) == 0) return(NULL)\r\n  \r\n  pattern2 = \"-(\\\\d.+)/\"\r\n  match2 = regexpr(pattern2, strMatch[1])\r\n  attr(match2, 'useBytes') <- FALSE\r\n  strmatch = regmatches(strMatch[1], match2)\r\n  if (length(strmatch) == 0) return(NULL)\r\n  \r\n  # CDN url is https://cdn.plot.ly/plotly-<Version>.js\r\n  # This matches the specific version used in the plotly package used.\r\n  verstr = substr(strmatch, 2, nchar(strmatch)-1)\r\n  str = paste('https://cdn.plot.ly/plotly-', verstr,'.min.js', sep='')\r\n  return(str)\r\n}\r\n#################################################\r\n\r\n\r\n####################################################\r\n############ Library declarations\r\n## Plotting libraries\r\nlibraryRequireInstall(\"ggplot2\")\r\n\r\nlibraryRequireInstall(\"plotly\")\r\n\r\nlibraryRequireInstall(\"ggplotly\")\r\n\r\nlibraryRequireInstall(\"gapminder\")\r\n\r\nlibraryRequireInstall(\"gsubfn\")\r\n## Datastream parsing library\r\nlibraryRequireInstall(\"magrittr\")\r\n\r\n## HTML function and output facilitator libraries\r\nlibraryRequireInstall(\"htmlwidgets\")\r\n\r\nlibraryRequireInstall(\"XML\")\r\n\r\n\r\n\r\n####################################################\r\n\r\ndisabledButtonsList <- list('toImage', 'sendDataToCloud')\r\nerrorText <- NULL\r\n####### Data validation\r\nReadFullFileReplaceString <- function(fnameIn, fnameOut, sourceString,targetString)\r\n{\r\n  if(!file.exists(fnameIn))\r\n    return(NULL)\r\n  \r\n  tx  <- readLines(fnameIn)\r\n  tx2  <- gsub(pattern = sourceString, replace = targetString, x = tx)\r\n  writeLines(tx2, con = fnameOut)\r\n}\r\nmodify_measuretext <- function(text_measure)\r\n{\r\n  var_text1 <- text_measure\r\n    text_tool1 <- substr(var_text1,1,20)\r\n    if(nchar(text_measure)< 20) \r\n    {\r\n      finaltext_measure1 <- text_tool1\r\n    } else {\r\n    finaltext_measure1 <- paste(text_tool1,\"...\")\r\n    }\r\n    return (finaltext_measure1)\r\n}\r\n###### Check if essential fields are given\r\nif ((!exists(\"Category\")) || (!exists(\"Value\")))\r\n{\r\n  xlayout <- list(\r\n    title = \"Please provide with the category and at least one measure\",\r\n    zeroline = FALSE,\r\n    showline = FALSE,\r\n    showticklabels = FALSE,\r\n    showgrid = FALSE\r\n  )\r\n  ylayout <- list(\r\n    title = \"\",\r\n    zeroline = FALSE,\r\n    showline = FALSE,\r\n    showticklabels = FALSE,\r\n    showgrid = FALSE\r\n  )\r\n  plotOutput <- plot_ly() %>% \r\n  layout(title = '',\r\n         xaxis = xlayout,\r\n         yaxis = ylayout)\r\n  plotOutput$x$config$modeBarButtonsToRemove = disabledButtonsList\r\n    \r\n    ##Render the plot in power bi visual window\r\n    internalSaveWidget(config(\r\n      plotOutput,\r\n      collaborate = FALSE,\r\n      displaylogo = FALSE\r\n    ),\r\n    'out.html')\r\n  \r\n  quit()\r\n}\r\n### Initiate error handling\r\ntryCatch({\r\n  ##### Converting user data to data frames\r\n  sourceData <- data.frame(Category, Value)\r\n  userDataColNames <- colnames(sourceData)\r\n  userDataColNames <- gsub(\".\", \" \", userDataColNames, fixed = TRUE)\r\n  numberofValues <- ncol(Value)\r\n  \r\n  ##### Initializing default properties\r\n  lineSegmentColor <- \"#5F6B6D\"\r\n  \r\n  lineSegment2Color <- \"#8AD4EB\"\r\n  \r\n  lineSegment3Color <- \"#374649\"\r\n  \r\n  value1Color <- \"#01B8AA\"\r\n  \r\n  value2Color <- \"#FD625E\"\r\n  \r\n  value3Color <- \"#A66999\"\r\n  \r\n  value4Color <- \"#F2C80F\"\r\n  \r\n  yColor <- \"grey\"\r\n  \r\n  xColor <- \"grey\"\r\n  \r\n  ytextColor <- \"black\"\r\n  \r\n  xtextColor <- \"black\"\r\n  \r\n  chartColor <- \"white\"\r\n  \r\n  plotColor <- \"white\"\r\n  \r\n  leftMargin <- 80\r\n  \r\n  xtick <- TRUE\r\n  \r\n  ytick <- TRUE\r\n\r\n  legend <- TRUE\r\n  \r\n  \r\n  ####### Check for user definition of properties and asign them to their respective variables\r\n  if (exists(\"legend_show\")) {\r\n    legend <- legend_show\r\n  }\r\n  if (exists(\"visualColors_segmentColor\")) {\r\n    lineSegmentColor <- visualColors_segmentColor\r\n  }\r\n  if (exists(\"visualColors_segment2Color\")) {\r\n    lineSegment2Color <- visualColors_segment2Color\r\n  }\r\n  if (exists(\"visualColors_segment3Color\")) {\r\n    lineSegment3Color <- visualColors_segment3Color\r\n  }\r\n  if (exists(\"yAxis_labelColor\")) {\r\n    ytextColor <- yAxis_labelColor\r\n  }\r\n  if (exists(\"xAxis_labelColor\")) {\r\n    xtextColor <- xAxis_labelColor\r\n  }\r\n  if (exists(\"visualColors_valueColor1\")) {\r\n    value1Color <- visualColors_valueColor1\r\n  }\r\n  if (exists(\"visualColors_valueColor2\")) {\r\n    value2Color <- visualColors_valueColor2\r\n  }\r\n  if (exists(\"visualColors_valueColor3\")) {\r\n    value3Color <- visualColors_valueColor3\r\n  }\r\n  if (exists(\"visualColors_valueColor4\")) {\r\n    value4Color <- visualColors_valueColor4\r\n  }\r\n  if (exists(\"yAxis_titleColor\")) {\r\n    yColor <- yAxis_titleColor\r\n  }\r\n  if (exists(\"xAxis_titleColor\")) {\r\n    xColor <- xAxis_titleColor\r\n  }\r\n  if (exists(\"visualColors_lMargin\")) {\r\n    leftMargin <- visualColors_lMargin\r\n  }\r\n  if (exists(\"visualColors_plotColor\")) {\r\n    plotColor <- visualColors_plotColor\r\n  }\r\n  if (exists(\"visualColors_chartColor\")) {\r\n    chartColor <- visualColors_chartColor\r\n  }\r\n  if (exists(\"xAxis_showLabel\")) {\r\n    xtick <- xAxis_showLabel\r\n  }\r\n  if (exists(\"yAxis_showLabel\")) {\r\n    ytick <- yAxis_showLabel\r\n  }\r\n  ### Creating stylings for axis text\r\n  \r\n  titlefontx <- list(family = \"Arial, sans-serif\",\r\n                     size = 18,\r\n                     color = xColor)\r\n  titlefonty <- list(family = \"Arial, sans-serif\",\r\n                     size = 18,\r\n                     color = yColor)\r\n  tickfonty <- list(family = \"Old Standard TT, serif\",\r\n                    size = 14,\r\n                    color = ytextColor)\r\n  tickfontx <- list(family = \"Old Standard TT, serif\",\r\n                    size = 14,\r\n                    color = xtextColor)\r\n  \r\n  ## declaring constants\r\n  marginLeftVal <- 100\r\n  marginRightVal <- 0\r\n  marginTopVal <- 0\r\n  marginBottomVal <- 50\r\n  \r\n  #### Initiating plot for 4 measures\r\n  \r\n  if (numberofValues == 4) {\r\n    yLegend <- sprintf(\"%s\", userDataColNames[1])\r\n    \r\n    xLegend <-\r\n      sprintf(\r\n        \"Difference between %s, %s, %s and %s\",\r\n        userDataColNames[2],\r\n        userDataColNames[3],\r\n        userDataColNames[4],\r\n        userDataColNames[5]\r\n      )\r\n    \r\n    \r\n    if (exists(\"yAxis_titleText\")) {\r\n      yLegend <- yAxis_titleText\r\n    }\r\n    if (exists(\"xAxis_titleText\")) {\r\n      xLegend <- xAxis_titleText\r\n    }\r\n    \r\n     ##code for ellipses for 4 measures\r\n    text1 <- userDataColNames[2]\r\n    text_fi1 <- modify_measuretext(text1)\r\n    #2nd measure\r\n    text2 <- userDataColNames[3]\r\n    text_fi2 <- modify_measuretext(text2)\r\n    #3rd measure\r\n    text3 <- userDataColNames[4]\r\n    text_fi3 <- modify_measuretext(text3)\r\n    #4th measure\r\n    text4 <- userDataColNames[5]\r\n    text_fi4 <- modify_measuretext(text4)\r\n    colnames(sourceData) <-\r\n      c(\"Category\", \"Value1\", \"Value2\", \"Value3\", \"Value4\")\r\n    sourceData$Category <-\r\n      factor(sourceData$Category, levels = sourceData$Category[order(sourceData$Value3)])\r\n    \r\n    plotOutput <- plot_ly(sourceData) %>%\r\n      ##Add segments\r\n      add_segments(\r\n        x = ~ Value1,\r\n        xend = ~ Value2,\r\n        y = ~ Category,\r\n        yend = ~ Category,\r\n        showlegend = FALSE,\r\n        color = I(lineSegmentColor)\r\n      ) %>%\r\n      add_segments(\r\n        x = ~ Value2,\r\n        xend = ~ Value3,\r\n        y = ~ Category,\r\n        yend = ~ Category,\r\n        showlegend = FALSE,\r\n        color = I(lineSegment2Color)\r\n      ) %>%\r\n      add_segments(\r\n        x = ~ Value3,\r\n        xend = ~ Value4,\r\n        y = ~ Category,\r\n        yend = ~ Category,\r\n        showlegend = FALSE,\r\n        color = I(lineSegment3Color)\r\n      ) %>%\r\n      ##Add markers for value 1\r\n      add_markers(\r\n        x = ~ Value1,\r\n        y = ~ Category,\r\n        name = modify_measuretext(userDataColNames[2]),\r\n        color = I(value1Color),\r\n        text = ~ paste(Value1, '<br>', Category, '<br>', text_fi1),\r\n        type = 'scatter',\r\n        mode = 'markers',\r\n        showlegend = legend,\r\n        hoverinfo = \"text\"\r\n      ) %>%\r\n      ##Add markers for value 2\r\n      add_markers(\r\n        x = ~ Value2,\r\n        y = ~ Category,\r\n        name = modify_measuretext(userDataColNames[3]),\r\n        color = I(value2Color),\r\n        text = ~ paste(Value2, '<br>', Category, '<br>', text_fi2),\r\n        type = 'scatter',\r\n        mode = 'markers',\r\n        showlegend = legend,\r\n        hoverinfo = \"text\"\r\n      ) %>%\r\n      ##Add markers for value 3\r\n      add_markers(\r\n        x = ~ Value3,\r\n        y = ~ Category,\r\n        name = modify_measuretext(userDataColNames[4]),\r\n        color = I(value3Color),\r\n        text = ~ paste(Value3, '<br>', Category, '<br>', text_fi3),\r\n        type = 'scatter',\r\n        mode = 'markers',\r\n        showlegend = legend,\r\n        hoverinfo = \"text\"\r\n      ) %>%\r\n      ##Add markers for value 4\r\n      add_markers(\r\n        x = ~ Value4,\r\n        y = ~ Category,\r\n        name = modify_measuretext(userDataColNames[5]),\r\n        color = I(value4Color),\r\n        text = ~ paste(Value4, '<br>', Category, '<br>', text_fi4),\r\n        type = 'scatter',\r\n        mode = 'markers',\r\n        showlegend = legend,\r\n        hoverinfo = \"text\"\r\n      ) %>%\r\n      layout(\r\n        xaxis = list(\r\n          title = xLegend,\r\n          titlefont = titlefontx,\r\n          showticklabels = xtick,\r\n          tickfont = tickfontx\r\n        ),\r\n        yaxis = list(\r\n          title = yLegend,\r\n          titlefont = titlefonty,\r\n          showticklabels = ytick,\r\n          tickfont = tickfonty\r\n        ),\r\n        margin = list(\r\n          l = marginLeftVal,\r\n          r = marginRightVal,\r\n          t = marginTopVal,\r\n          b = marginBottomVal\r\n        ),\r\n        plot_bgcolor = chartColor,\r\n        paper_bgcolor = plotColor\r\n      )\r\n    plotOutput$x$config$modeBarButtonsToRemove = disabledButtonsList\r\n    \r\n    ##Render the plot in power bi visual window\r\n    internalSaveWidget(config(\r\n      plotOutput,\r\n      collaborate = FALSE,\r\n      displaylogo = FALSE\r\n    ),\r\n    'out.html')\r\n    \r\n  }\r\n  \r\n  \r\n  ####Initiating plot for 3 measures\r\n  if (numberofValues == 3) {\r\n    \r\n    yLegend <- sprintf(\"%s\", userDataColNames[1])\r\n    \r\n    xLegend <-\r\n      sprintf(\r\n        \"Difference between %s, %s and %s\",\r\n        userDataColNames[2],\r\n        userDataColNames[3],\r\n        userDataColNames[4]\r\n      )\r\n    \r\n    \r\n    if (exists(\"yAxis_titleText\")) {\r\n      yLegend <- yAxis_titleText\r\n    }\r\n    if (exists(\"xAxis_titleText\")) {\r\n      xLegend <- xAxis_titleText\r\n    }\r\n     ##code for ellipses for 3 measures\r\n    text1 <- userDataColNames[2]\r\n    text_fi1 <- modify_measuretext(text1)\r\n    #2nd measure\r\n    text2 <- userDataColNames[3]\r\n    text_fi2 <- modify_measuretext(text2)\r\n    #3rd measure\r\n    text3 <- userDataColNames[4]\r\n    text_fi3 <- modify_measuretext(text3)\r\n    colnames(sourceData) <-\r\n      c(\"Category\", \"Value1\", \"Value2\", \"Value3\")\r\n    sourceData$Category <-\r\n      factor(sourceData$Category, levels = sourceData$Category[order(sourceData$Value3)])\r\n    \r\n    plotOutput <- plot_ly(sourceData) %>%\r\n      ##Add segments\r\n      add_segments(\r\n        x = ~ Value1,\r\n        xend = ~ Value2,\r\n        y = ~ Category,\r\n        yend = ~ Category,\r\n        showlegend = FALSE,\r\n        color = I(lineSegmentColor)\r\n      ) %>%\r\n      add_segments(\r\n        x = ~ Value2,\r\n        xend = ~ Value3,\r\n        y = ~ Category,\r\n        yend = ~ Category,\r\n        showlegend = FALSE,\r\n        color = I(lineSegment2Color)\r\n      ) %>%\r\n      ##Add markers for value 1\r\n      add_markers(\r\n        x = ~ Value1,\r\n        y = ~ Category,\r\n        name = modify_measuretext(userDataColNames[2]),\r\n        color = I(value1Color),\r\n        text = ~ paste(Value1, '<br>', Category, '<br>', text_fi1),\r\n        type = 'scatter',\r\n        mode = 'markers',\r\n        showlegend = legend,\r\n        hoverinfo = \"text\"\r\n      ) %>%\r\n      ##Add markers for value 2\r\n      add_markers(\r\n        x = ~ Value2,\r\n        y = ~ Category,\r\n        name = modify_measuretext(userDataColNames[3]),\r\n        color = I(value2Color),\r\n        text = ~ paste(Value2, '<br>', Category, '<br>', text_fi2),\r\n        type = 'scatter',\r\n        mode = 'markers',\r\n        showlegend = legend,\r\n        hoverinfo = \"text\"\r\n      ) %>%\r\n      ##Add markers for value 3\r\n      add_markers(\r\n        x = ~ Value3,\r\n        y = ~ Category,\r\n        name = modify_measuretext(userDataColNames[4]),\r\n        color = I(value3Color),\r\n        text = ~ paste(Value3, '<br>', Category, '<br>', text_fi3),\r\n        type = 'scatter',\r\n        mode = 'markers',\r\n        showlegend = legend,\r\n        hoverinfo = \"text\"\r\n      ) %>%\r\n      layout(\r\n        xaxis = list(\r\n          title = xLegend,\r\n          titlefont = titlefontx,\r\n          showticklabels = xtick,\r\n          tickfont = tickfontx\r\n        ),\r\n        yaxis = list(\r\n          title = yLegend,\r\n          titlefont = titlefonty,\r\n          showticklabels = ytick,\r\n          tickfont = tickfonty\r\n        ),\r\n        margin = list(\r\n          l = marginLeftVal,\r\n          r = marginRightVal,\r\n          t = marginTopVal,\r\n          b = marginBottomVal\r\n        ),\r\n        plot_bgcolor = chartColor,\r\n        paper_bgcolor = plotColor\r\n      )\r\n    \r\n    plotOutput$x$config$modeBarButtonsToRemove = disabledButtonsList\r\n    ##Render the plot in power bi visual window\r\n    internalSaveWidget(config(\r\n      plotOutput,\r\n      collaborate = FALSE,\r\n      displaylogo = FALSE\r\n    ),\r\n    'out.html')\r\n    \r\n  }\r\n  \r\n  ####Initiating plot for 2 measures\r\n  if (numberofValues == 2) {\r\n    yLegend <- sprintf(\"%s\", userDataColNames[1])\r\n    \r\n    xLegend <-\r\n      sprintf(\"Difference between %s and %s\",\r\n              userDataColNames[2],\r\n              userDataColNames[3])\r\n    \r\n    \r\n    if (exists(\"yAxis_titleText\")) {\r\n      yLegend <- yAxis_titleText\r\n    }\r\n    if (exists(\"xAxis_titleText\")) {\r\n      xLegend <- xAxis_titleText\r\n    }\r\n    ##code for ellipses for 2 measures\r\n    text1 <- userDataColNames[2]\r\n    text_fi1 <- modify_measuretext(text1)\r\n    #2nd measure\r\n    text2 <- userDataColNames[3]\r\n    text_fi2 <- modify_measuretext(text2)\r\n\r\n    colnames(sourceData) <- c(\"Category\", \"Value1\", \"Value2\")\r\n    sourceData$Category <-\r\n      factor(sourceData$Category, levels = sourceData$Category[order(sourceData$Category)])\r\n    sd <- ~ Value1\r\n     sizevw <- dev.size(\"px\")\r\n      if(sizevw < 500) {\r\n        showlegend: FALSE\r\n      }\r\n    plotOutput <- plot_ly(sourceData) %>%\r\n      ##Add segments\r\n      add_segments(\r\n        x = ~ Value1,\r\n        xend = ~ Value2,\r\n        y = ~ Category,\r\n        yend = ~ Category,\r\n        showlegend = FALSE,\r\n        color = I(lineSegmentColor)\r\n      ) %>%\r\n      ##Add markers for value 1\r\n      add_markers(\r\n        x = ~ Value1,\r\n        y = ~ Category,\r\n        name = modify_measuretext(userDataColNames[2]),\r\n        color = I(value1Color),\r\n        text = ~ paste(Value1, '<br>', Category, '<br>', text_fi1),\r\n        type = 'scatter',\r\n        mode = 'markers',\r\n        showlegend = legend,\r\n        hoverinfo = \"text\"\r\n      ) %>%\r\n      ##Add markers for value 2\r\n      add_markers(\r\n        x = ~ Value2,\r\n        y = ~ Category,\r\n        name = modify_measuretext(userDataColNames[3]),\r\n        color = I(value2Color),\r\n        text = ~ paste(Value2, '<br>', Category, '<br>', text_fi2),\r\n        type = 'scatter',\r\n        mode = 'markers',\r\n        showlegend = legend,\r\n        hoverinfo = \"text\"\r\n      ) %>%\r\n     \r\n      layout(\r\n        xaxis = list(\r\n          title = xLegend,\r\n          titlefont = titlefontx,\r\n          showticklabels = xtick,\r\n          tickfont = tickfontx\r\n        ),\r\n        yaxis = list(\r\n          title = yLegend,\r\n          titlefont = titlefonty,\r\n          showticklabels = ytick,\r\n          tickfont = tickfonty\r\n        ),\r\n        margin = list(\r\n          l = marginLeftVal,\r\n          r = marginRightVal,\r\n          t = marginTopVal,\r\n          b = marginBottomVal\r\n        ),\r\n        plot_bgcolor = chartColor,\r\n        paper_bgcolor = plotColor                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           \r\n      )\r\n    \r\n    plotOutput$x$config$modeBarButtonsToRemove = disabledButtonsList\r\n    ##Render the plot in power bi visual window\r\n    internalSaveWidget(config(\r\n      plotOutput,\r\n      collaborate = FALSE,\r\n      displaylogo = FALSE\r\n    ),\r\n    'out.html')\r\n    \r\n  }\r\n  \r\n  ####Initiating plot for 1 measure\r\n  if (numberofValues == 1) {\r\n    yLegend <- sprintf(\"%s\", userDataColNames[1])\r\n    \r\n    xLegend <- sprintf(\"%s\", userDataColNames[2])\r\n    \r\n    \r\n    if (exists(\"yAxis_titleText\")) {\r\n      yLegend <- yAxis_titleText\r\n    }\r\n    if (exists(\"xAxis_titleText\")) {\r\n      xLegend <- xAxis_titleText\r\n    }\r\n     #1st measure\r\n    text2 <- userDataColNames[2]\r\n    text_fi2 <- modify_measuretext(text2)\r\n    colnames(sourceData) <- c(\"Category\", \"Value1\")\r\n    sourceData$Category <-\r\n      factor(sourceData$Category, levels = sourceData$Category[order(sourceData$Value1)])\r\n    \r\n    plotOutput <-\r\n      plot_ly(sourceData, color = I(lineSegmentColor)) %>%\r\n      ##Add markers\r\n      add_markers(\r\n        x = ~ Value1,\r\n        y = ~ Category,\r\n        name = modify_measuretext(userDataColNames[2]),\r\n        color = I(value1Color),\r\n        text = ~ paste(Value1, '<br>', Category, '<br>', text_fi2),\r\n        type = 'scatter',\r\n        mode = 'markers',\r\n        showlegend = legend,\r\n        hoverinfo = \"text\"\r\n      ) %>%\r\n      \r\n      layout(\r\n        xaxis = list(\r\n          title = xLegend,\r\n          titlefont = titlefontx,\r\n          showticklabels = xtick,\r\n          tickfont = tickfontx\r\n        ),\r\n        yaxis = list(\r\n          title = yLegend,\r\n          titlefont = titlefonty,\r\n          showticklabels = ytick,\r\n          tickfont = tickfonty\r\n        ),\r\n        margin = list(\r\n          l = marginLeftVal,\r\n          r = marginRightVal,\r\n          t = marginTopVal,\r\n          b = marginBottomVal\r\n        ),\r\n        plot_bgcolor = chartColor,\r\n        paper_bgcolor = plotColor\r\n      )\r\n    \r\n    plotOutput$x$config$modeBarButtonsToRemove = disabledButtonsList\r\n    ##Render the plot in power bi visual window\r\n    internalSaveWidget(config(\r\n      plotOutput,\r\n      collaborate = FALSE,\r\n      displaylogo = FALSE\r\n    ),\r\n    'out.html')\r\n    \r\n  }\r\n},\r\n\r\n#######Handle error and display message\r\nerror = function(e) {\r\n  xlayout <- list(\r\n    title = sprintf(\"Error:%s: Please build the model again using suitable values\", e),\r\n    zeroline = FALSE,\r\n    showline = FALSE,\r\n    showticklabels = FALSE,\r\n    showgrid = FALSE\r\n  )\r\n  ylayout <- list(\r\n    title = \"\",\r\n    zeroline = FALSE,\r\n    showline = FALSE,\r\n    showticklabels = FALSE,\r\n    showgrid = FALSE\r\n  )\r\n  plotOutput <- plot_ly() %>%\r\n    layout(title = '',\r\n           xaxis = xlayout,\r\n           yaxis = ylayout)\r\n  \r\n  plotOutput$x$config$modeBarButtonsToRemove = disabledButtonsList\r\n  internalSaveWidget(plotOutput, 'out.html')\r\n  \r\n  quit()\r\n  \r\n})\r\nReadFullFileReplaceString('out.html', 'out.html', ',\"padding\":40,', ',\"padding\":0,')"}}}],"objects":{"rcv_script":{"properties":{"provider":{"type":{"text":true}},"source":{"type":{"scripting":{"source":true}}}}},"visualColors":{"displayName":"Colors","properties":{"valueColor1":{"displayName":"Measure 1","description":"First measure color","type":{"fill":{"solid":{"color":true}}}},"valueColor2":{"displayName":"Measure 2","description":"Second measure color","type":{"fill":{"solid":{"color":true}}}},"valueColor3":{"displayName":"Measure 3","description":"Third measure color","type":{"fill":{"solid":{"color":true}}}},"valueColor4":{"displayName":"Measure 4","description":"Fourth measure color","type":{"fill":{"solid":{"color":true}}}},"segmentColor":{"displayName":"Connector 1","description":"First connector color","type":{"fill":{"solid":{"color":true}}}},"segment2Color":{"displayName":"Connector 2","description":"Second connector color","type":{"fill":{"solid":{"color":true}}}},"segment3Color":{"displayName":"Connector 3","description":"Third connector color","type":{"fill":{"solid":{"color":true}}}},"chartColor":{"displayName":"Plot background","description":"Color of plot background","type":{"fill":{"solid":{"color":true}}}},"plotColor":{"displayName":"Axis background","description":"Color of axis backgroud","type":{"fill":{"solid":{"color":true}}}}}},"xAxis":{"displayName":"X-axis","properties":{"titleText":{"displayName":"Title","description":"Enter the title for x-axis","placeHolderText":"Auto","type":{"text":true},"suppressFormatPainterCopy":false},"showLabel":{"displayName":"Label","description":"X-axis label","type":{"bool":true},"suppressFormatPainterCopy":false},"labelColor":{"displayName":"Label color","description":"Color of x-axis label","type":{"fill":{"solid":{"color":true}}}},"titleColor":{"displayName":"Title color","description":"Color of legend text on x-axis","type":{"fill":{"solid":{"color":true}}}}}},"yAxis":{"displayName":"Y-axis","properties":{"titleText":{"displayName":"Title","description":"Enter the title for y-axis","placeHolderText":"Auto","type":{"text":true},"suppressFormatPainterCopy":false},"showLabel":{"displayName":"Label","description":"Y-axis label","type":{"bool":true},"suppressFormatPainterCopy":false},"labelColor":{"displayName":"Label color","description":"Color of y-axis label","type":{"fill":{"solid":{"color":true}}}},"titleColor":{"displayName":"Title color","description":"Color of legend text on y-axis","type":{"fill":{"solid":{"color":true}}}}}},"legend":{"displayName":"Legend","properties":{"show":{"displayName":"Show","type":{"bool":true}}}}},"suppressDefaultTitle":true},"dependencies":{"cranPackages":[{"name":"ggplot2","displayName":"GG Plot 2","url":"https://cran.r-project.org/web/packages/ggplot2/index.html"},{"name":"plotly","displayName":"Plotly","url":"https://cran.r-project.org/web/packages/plotly/index.html"},{"name":"htmlwidgets","displayName":"HTML Widgets","url":"https://cran.r-project.org/web/packages/htmlwidgets/index.html"},{"name":"XML","displayName":"XML","url":"https://cran.r-project.org/web/packages/XML/index.html"},{"name":"magrittr","displayName":"magrittr","url":"https://cran.r-project.org/web/packages/magrittr/index.html"}]},"stringResources":{},"content":{"js":"var powerbi;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){function t(e,t,r){void 0===e&&(e=[]);var i=e;return o(i),t&&(i.identityFields=t),r&&(i.source=r),i}function o(e,t){e.grouped=t?function(){return t}:function(){return r(e)}}function r(e){for(var t,o=[],r=0,i=e.length;i>r;r++){var a=e[r];if(!t||t.identity!==a.identity){if(t={values:[]},a.identity){t.identity=a.identity;var l=a.source;void 0!==l.groupName?t.name=l.groupName:l.displayName&&(t.name=l.displayName)}o.push(t)}t.values.push(a)}return o}e.createValueColumns=t,e.setGrouped=o,e.groupValues=r}(t=e.DataViewTransform||(e.DataViewTransform={}))}(t=e.dataview||(e.dataview={}))}(t=e.utils||(e.utils={}))}(t=e.extensibility||(e.extensibility={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){function t(e,t){if(!e||!e.length)return-1;var o=e[0];if(o.values&&o.values.length>0)for(var i=0,a=o.values.length;a>i;++i){var l=o.values[i];if(l&&l.source&&r(l.source,t))return i}return-1}function o(e,t){if(e&&e.length)for(var o=0,i=e.length;i>o;o++)if(r(e[o].source,t))return o;return-1}function r(e,t){var o=e.roles;return o&&o[t]}function i(e,t){return null!=e&&null!=e.metadata&&e.metadata.columns&&e.metadata.columns.some(function(e){return e.roles&&void 0!==e.roles[t]})}function a(e,t){return e&&e.source&&e.source.roles&&e.source.roles[t]===!0}e.getMeasureIndexOfRole=t,e.getCategoryIndexOfRole=o,e.hasRole=r,e.hasRoleInDataView=i,e.hasRoleInValueColumn=a}(t=e.DataRoleHelper||(e.DataRoleHelper={}))}(t=e.dataview||(e.dataview={}))}(t=e.utils||(e.utils={}))}(t=e.extensibility||(e.extensibility={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){function t(e,t,o){if(!e)return o;var r=e[t];return void 0===r?o:r}function o(e,o,r){var i=t(e,o);return i&&i.solid?i.solid.color:r}e.getValue=t,e.getFillColorByPropertyName=o}(t=e.DataViewObject||(e.DataViewObject={}))}(t=e.dataview||(e.dataview={}))}(t=e.utils||(e.utils={}))}(t=e.extensibility||(e.extensibility={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(t){function o(t,o,r){return t?e.DataViewObject.getValue(t[o.objectName],o.propertyName,r):r}function r(e,t,o){return e&&e[t]?e[t]:o}function i(e,t,r){var i=o(e,t);return i&&i.solid?i.solid.color:r}function a(e,t,r){var i=o(e,t,r);return i&&i.solid?i.solid.color:void 0===i||null===i||\"object\"==typeof i&&!i.solid?r:i}t.getValue=o,t.getObject=r,t.getFillColor=i,t.getCommonValue=a}(t=e.DataViewObjects||(e.DataViewObjects={}))}(t=e.dataview||(e.dataview={}))}(t=e.utils||(e.utils={}))}(t=e.extensibility||(e.extensibility={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var o;!function(t){var o;!function(t){var o,r=e.extensibility.utils.dataview.DataRoleHelper;!function(e){function t(e,t,o){if(e.categories&&e.categories.length>0){var i=e.categories[0];return i.source&&r.hasRole(i.source,t)&&r.hasRole(i.source,o)}return!1}function o(e){return void 0!==e.groupName?e.groupName:e.queryName}function i(e){var t=l(e);return null!=t&&t.imageUrl===!0}function a(e){var t=l(e);return null!=t&&t.webUrl===!0}function l(e){return e&&e.type&&e.type.misc}function n(e){return e&&e.metadata&&e.metadata.columns&&e.metadata.columns.length?e.metadata.columns.some(function(e){return i(e)===!0}):!1}e.categoryIsAlsoSeriesRole=t,e.getSeriesName=o,e.isImageUrlColumn=i,e.isWebUrlColumn=a,e.getMiscellaneousTypeDescriptor=l,e.hasImageUrlColumn=n}(o=t.converterHelper||(t.converterHelper={}))}(o=t.dataview||(t.dataview={}))}(o=t.utils||(t.utils={}))}(t=e.extensibility||(e.extensibility={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t=function(){function t(){}return t.getDefault=function(){return new this},t.createPropertyIdentifier=function(e,t){return{objectName:e,propertyName:t}},t.parse=function(t){var o,r=this.getDefault();if(!t||!t.metadata||!t.metadata.objects)return r;o=r.getProperties();for(var i in o)for(var a in o[i]){var l=r[i][a];r[i][a]=e.DataViewObjects.getCommonValue(t.metadata.objects,o[i][a],l)}return r},t.isPropertyEnumerable=function(e){return!t.InnumerablePropertyPrefix.test(e)},t.enumerateObjectInstances=function(e,t){var o=e&&e[t.objectName];if(!o)return[];var r={objectName:t.objectName,selector:null,properties:{}};for(var i in o)o.hasOwnProperty(i)&&(r.properties[i]=o[i]);return{instances:[r]}},t.prototype.getProperties=function(){var e=this,o={},r=Object.keys(this);return r.forEach(function(r){if(t.isPropertyEnumerable(r)){var i=Object.keys(e[r]);o[r]={},i.forEach(function(e){t.isPropertyEnumerable(r)&&(o[r][e]=t.createPropertyIdentifier(r,e))})}}),o},t}();t.InnumerablePropertyPrefix=/^_/,e.DataViewObjectsParser=t}(t=e.dataview||(e.dataview={}))}(t=e.utils||(e.utils={}))}(t=e.extensibility||(e.extensibility={}))}(powerbi||(powerbi={}));var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)},powerbi;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){\"use strict\";function t(){l=0}function o(){return 0===l}function r(e,t){var o=[];if(e&&e.hasChildNodes()){for(var r=e.children,a=0;a<r.length;a++){var l=void 0;l=\"script\"===r.item(a).nodeName.toLowerCase()?i(r.item(a)):r.item(a).cloneNode(!0),t.appendChild(l),o.push(l)}return o}}function i(e){for(var t=document.createElement(\"script\"),o=e.attributes,r=0;r<o.length;r++)t.setAttribute(o[r].name,o[r].textContent),\"src\"===o[r].name.toLowerCase()&&(l++,t.onload=function(){l--});return t.innerHTML=e.innerHTML,t}function a(){var e=window.setInterval(function(){o()&&(window.clearInterval(e),window.hasOwnProperty(\"HTMLWidgets\")&&window.HTMLWidgets.staticRender&&window.HTMLWidgets.staticRender())},100)}var l=0;e.ResetInjector=t,e.injectorReady=o,e.ParseElement=r,e.RunHTMLWidgetRenderer=a}(t=e.DumbbellChartB13A88DFEE724350B46BCF0EFA5B6E321||(e.DumbbellChartB13A88DFEE724350B46BCF0EFA5B6E321={}))}(t=e.visual||(e.visual={}))}(t=e.extensibility||(e.extensibility={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var o;!function(t){var o;!function(t){\"use strict\";var o=e.extensibility.utils.dataview.DataViewObjectsParser,r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(o);t.VisualSettings=r;var i;!function(e){function t(e,t,o){if(!e)return o;var r;r=e[t.objectName];var i;return i=r,a.getValue(i,t.propertyName,o)}function o(e,t,o){if(e&&e[t]){var r=void 0;return r=e[t]}return o}function r(e,t){if(e&&e[t]){var o=void 0;return o=e[t]}}function i(e,o,r){var i;return i=t(e,o),i&&i.solid?i.solid.color:r}e.getValue=t,e.getObject=o,e.getUserDefinedObjects=r,e.getFillColor=i}(i=t.DataViewObjects||(t.DataViewObjects={}));var a;!function(e){function t(e,t,o){if(!e)return o;var r;return r=e[t],void 0===r?o:r}function o(t,o,r){var i;return i=e.getValue(t,o),i&&i.solid?i.solid.color:r}e.getValue=t,e.getFillColorByPropertyName=o}(a=t.DataViewObject||(t.DataViewObject={})),t.chartProp={IVisualColors:{valueColor1:{objectName:\"visualColors\",propertyName:\"valueColor1\"},valueColor2:{objectName:\"visualColors\",propertyName:\"valueColor2\"},valueColor3:{objectName:\"visualColors\",propertyName:\"valueColor3\"},valueColor4:{objectName:\"visualColors\",propertyName:\"valueColor4\"},segmentColor:{objectName:\"visualColors\",propertyName:\"segmentColor\"},segment2Color:{objectName:\"visualColors\",propertyName:\"segment2Color\"},segment3Color:{objectName:\"visualColors\",propertyName:\"segment3Color\"},chartColor:{objectName:\"visualColors\",propertyName:\"chartColor\"},plotColor:{objectName:\"visualColors\",propertyName:\"plotColor\"}},IXaxisText:{xtitleText:{objectName:\"xAxis\",propertyName:\"titleText\"},xtextColor:{objectName:\"xAxis\",propertyName:\"labelColor\"},xlegendColor:{objectName:\"xAxis\",propertyName:\"titleColor\"},xLegend:{objectName:\"xAxis\",propertyName:\"showLabel\"}},IYaxisText:{ytitleText:{objectName:\"yAxis\",propertyName:\"titleText\"},ytextColor:{objectName:\"yAxis\",propertyName:\"labelColor\"},ylegendColor:{objectName:\"yAxis\",propertyName:\"titleColor\"},yLegend:{objectName:\"yAxis\",propertyName:\"showLabel\"}},legend:{show:{objectName:\"legend\",propertyName:\"show\"}}}}(o=t.DumbbellChartB13A88DFEE724350B46BCF0EFA5B6E321||(t.DumbbellChartB13A88DFEE724350B46BCF0EFA5B6E321={}))}(o=t.visual||(t.visual={}))}(t=e.extensibility||(e.extensibility={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var o;!function(t){var o;!function(t){\"use strict\";var o=!1,r=[e.VisualUpdateType.Resize,e.VisualUpdateType.ResizeEnd,e.VisualUpdateType.Resize+e.VisualUpdateType.ResizeEnd],i=function(){function e(e){e&&e.element&&(this.rootElement=e.element),this.headNodes=[],this.bodyNodes=[]}return e.prototype.update=function(t){if(t&&t.type&&t.viewport&&t.dataViews&&0!==t.dataViews.length&&t.dataViews[0]){var o=t.dataViews[0];this.settings=e.parseSettings(o),this.visualColorsSettings=this.getVisualColors(o),this.xaxisTextSettings=this.getXaxisText(o),this.yaxisTextSettings=this.getYaxisText(o),this.legendSettings=this.getLegend(o);var i=null;o.scriptResult&&o.scriptResult.payloadBase64&&(i=o.scriptResult.payloadBase64),-1===r.indexOf(t.type)?i&&this.injectCodeFromPayload(i):this.onResizing(t.viewport)}},e.prototype.getDefaultXaxisText=function(){return{xtitleText:\"\",xlegendColor:\"grey\",xtextColor:\"black\",xLegend:!0}},e.prototype.getDefaultYaxisText=function(){return{ytitleText:\"\",ylegendColor:\"grey\",ytextColor:\"black\",yLegend:!0}},e.prototype.getDefaultLegend=function(){return{show:!0}},e.prototype.getDefaultVisualColors=function(){return{valueColor1:\"#01B8AA\",valueColor2:\"#FD625E\",valueColor3:\"#A66999\",valueColor4:\"#F2C80F\",segmentColor:\"#5F6B6D\",segment2Color:\"#8AD4EB\",segment3Color:\"#374649\",plotColor:\"white\",chartColor:\"white\"}},e.prototype.getVisualColors=function(e){var o=this.getDefaultVisualColors(),r=null;return e.metadata&&e.metadata.objects?(r=e.metadata.objects,o.valueColor1=t.DataViewObjects.getFillColor(r,t.chartProp.IVisualColors.valueColor1,o.valueColor1),o.valueColor2=t.DataViewObjects.getFillColor(r,t.chartProp.IVisualColors.valueColor2,o.valueColor2),o.valueColor3=t.DataViewObjects.getFillColor(r,t.chartProp.IVisualColors.valueColor3,o.valueColor3),o.valueColor4=t.DataViewObjects.getFillColor(r,t.chartProp.IVisualColors.valueColor4,o.valueColor4),o.segmentColor=t.DataViewObjects.getFillColor(r,t.chartProp.IVisualColors.segmentColor,o.segmentColor),o.segment2Color=t.DataViewObjects.getFillColor(r,t.chartProp.IVisualColors.segment2Color,o.segment2Color),o.segment3Color=t.DataViewObjects.getFillColor(r,t.chartProp.IVisualColors.segment3Color,o.segment3Color),o.chartColor=t.DataViewObjects.getFillColor(r,t.chartProp.IVisualColors.chartColor,o.chartColor),o.plotColor=t.DataViewObjects.getFillColor(r,t.chartProp.IVisualColors.plotColor,o.plotColor),o):o},e.prototype.getXaxisText=function(e){var o=this.getDefaultXaxisText(),r=null;return e.metadata&&e.metadata.objects?(r=e.metadata.objects,o.xtitleText=t.DataViewObjects.getValue(r,t.chartProp.IXaxisText.xtitleText,o.xtitleText),o.xlegendColor=t.DataViewObjects.getFillColor(r,t.chartProp.IXaxisText.xlegendColor,o.xlegendColor),o.xtextColor=t.DataViewObjects.getFillColor(r,t.chartProp.IXaxisText.xtextColor,o.xtextColor),o.xLegend=t.DataViewObjects.getValue(r,t.chartProp.IXaxisText.xLegend,o.xLegend),o):o},e.prototype.getYaxisText=function(e){var o=this.getDefaultYaxisText(),r=null;return e.metadata&&e.metadata.objects?(r=e.metadata.objects,o.ytitleText=t.DataViewObjects.getValue(r,t.chartProp.IYaxisText.ytitleText,o.ytitleText),o.ylegendColor=t.DataViewObjects.getFillColor(r,t.chartProp.IYaxisText.ylegendColor,o.ylegendColor),o.ytextColor=t.DataViewObjects.getFillColor(r,t.chartProp.IYaxisText.ytextColor,o.ytextColor),o.yLegend=t.DataViewObjects.getValue(r,t.chartProp.IYaxisText.yLegend,o.yLegend),o):o},e.prototype.getLegend=function(e){var o=this.getDefaultLegend(),r=null;return e.metadata&&e.metadata.objects?(r=e.metadata.objects,o.show=t.DataViewObjects.getValue(r,t.chartProp.legend.show,o.show),o):o},e.prototype.onResizing=function(e){},e.prototype.injectCodeFromPayload=function(e){if(t.ResetInjector(),e){var r=document.createElement(\"html\");try{r.innerHTML=window.atob(e)}catch(i){return}if(o||0===this.headNodes.length){for(;this.headNodes.length>0;){var a=this.headNodes.pop();document.head.removeChild(a)}var l=r.getElementsByTagName(\"head\");if(l&&l.length>0){var n=l[0];this.headNodes=t.ParseElement(n,document.head)}}for(;this.bodyNodes.length>0;){var a=this.bodyNodes.pop();this.rootElement.removeChild(a)}var s=r.getElementsByTagName(\"body\");if(s&&s.length>0){var u=s[0];this.bodyNodes=t.ParseElement(u,this.rootElement)}t.RunHTMLWidgetRenderer()}},e.parseSettings=function(e){return t.VisualSettings.parse(e)},e.prototype.enumerateObjectInstances=function(e){var t;t=e.objectName;var o;o=[];var r={};switch(t){case\"visualColors\":o.push({objectName:t,properties:{valueColor1:this.visualColorsSettings.valueColor1,valueColor2:this.visualColorsSettings.valueColor2,valueColor3:this.visualColorsSettings.valueColor3,valueColor4:this.visualColorsSettings.valueColor4,segmentColor:this.visualColorsSettings.segmentColor,segment2Color:this.visualColorsSettings.segment2Color,segment3Color:this.visualColorsSettings.segment3Color,plotColor:this.visualColorsSettings.plotColor,chartColor:this.visualColorsSettings.chartColor},selector:null});break;case\"xAxis\":r=this.xaxisTextSettings.xLegend===!0?{titleText:this.xaxisTextSettings.xtitleText,titleColor:this.xaxisTextSettings.xlegendColor,showLabel:this.xaxisTextSettings.xLegend,labelColor:this.xaxisTextSettings.xtextColor}:{titleText:this.xaxisTextSettings.xtitleText,titleColor:this.xaxisTextSettings.xlegendColor,showLabel:this.xaxisTextSettings.xLegend},o.push({objectName:t,properties:r,selector:null});break;case\"yAxis\":r=this.yaxisTextSettings.yLegend===!0?{titleText:this.yaxisTextSettings.ytitleText,titleColor:this.yaxisTextSettings.ylegendColor,showLabel:this.yaxisTextSettings.yLegend,labelColor:this.yaxisTextSettings.ytextColor}:{titleText:this.yaxisTextSettings.ytitleText,titleColor:this.yaxisTextSettings.ylegendColor,showLabel:this.yaxisTextSettings.yLegend},o.push({objectName:t,properties:r,selector:null});break;case\"legend\":o.push({objectName:t,properties:{show:this.legendSettings.show},selector:null})}return o},e}();t.DumbbellChart=i}(o=t.DumbbellChartB13A88DFEE724350B46BCF0EFA5B6E321||(t.DumbbellChartB13A88DFEE724350B46BCF0EFA5B6E321={}))}(o=t.visual||(t.visual={}))}(t=e.extensibility||(e.extensibility={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var o;!function(t){t.DumbbellChartB13A88DFEE724350B46BCF0EFA5B6E321={name:\"DumbbellChartB13A88DFEE724350B46BCF0EFA5B6E321\",displayName:\"Dumbbell Chart by MAQ Software\",\"class\":\"DumbbellChart\",version:\"3.0.4\",apiVersion:\"1.8.0\",create:function(t){return new e.extensibility.visual.DumbbellChartB13A88DFEE724350B46BCF0EFA5B6E321.DumbbellChart(t)},custom:!0}}(o=t.plugins||(t.plugins={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));","css":".visual-DumbbellChartB13A88DFEE724350B46BCF0EFA5B6E321 .rcv_autoScaleImageContainer{position:relative}.visual-DumbbellChartB13A88DFEE724350B46BCF0EFA5B6E321 .rcv_autoScaleImageContainer .rcv_autoScaleImage{max-width:100%;max-height:100%;position:absolute;top:50%;left:50%;transform:translateY(-50%) translateX(-50%);-webkit-transform:translateY(-50%) translateX(-50%)}","iconBase64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFEmlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDIgNzkuMTYwOTI0LCAyMDE3LzA3LzEzLTAxOjA2OjM5ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgKFdpbmRvd3MpIiB4bXA6Q3JlYXRlRGF0ZT0iMjAxNy0xMi0wNlQxNjowMDo0NCswNTozMCIgeG1wOk1vZGlmeURhdGU9IjIwMTctMTItMDZUMTY6MDg6MjYrMDU6MzAiIHhtcDpNZXRhZGF0YURhdGU9IjIwMTctMTItMDZUMTY6MDg6MjYrMDU6MzAiIGRjOmZvcm1hdD0iaW1hZ2UvcG5nIiBwaG90b3Nob3A6Q29sb3JNb2RlPSIzIiBwaG90b3Nob3A6SUNDUHJvZmlsZT0ic1JHQiBJRUM2MTk2Ni0yLjEiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NzcwNzRkMGQtYTI3ZC1iODRmLTkzYmQtODhlOTI0ZWE2ODg0IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjc3MDc0ZDBkLWEyN2QtYjg0Zi05M2JkLTg4ZTkyNGVhNjg4NCIgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOjc3MDc0ZDBkLWEyN2QtYjg0Zi05M2JkLTg4ZTkyNGVhNjg4NCI+IDx4bXBNTTpIaXN0b3J5PiA8cmRmOlNlcT4gPHJkZjpsaSBzdEV2dDphY3Rpb249ImNyZWF0ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6NzcwNzRkMGQtYTI3ZC1iODRmLTkzYmQtODhlOTI0ZWE2ODg0IiBzdEV2dDp3aGVuPSIyMDE3LTEyLTA2VDE2OjAwOjQ0KzA1OjMwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgKFdpbmRvd3MpIi8+IDwvcmRmOlNlcT4gPC94bXBNTTpIaXN0b3J5PiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PiaJS7kAAAF0SURBVDiN5ZOxTsJQFIa/QisETOhgZ0x8AEpi4tTIG8DEan0C2U0DDYtjH8BE5k6YuDiJYXIqPoIzDpAIAQvUoTS5lMKEg/Gfbv+c++Wcv+dKQRBwSKUOSvsNoBwdbNfTAQe4BB6BVrNeHuy6OOy3daADlNb1pmZYI1mo6QLF9bmay8inQGNnK1LqiWCVj+rX8JoILIr10/miBLwksfzxBwSruF0FYWRgDBSij+OsMgPekoApJZ8FLmL2exzYIMywAIy/Zr5JGMOW0rkTABN4EJoxASRxD23XUwEdGDTr5VESTNSw31YBXTOsXuRJ/3ixAWzXqwAVoLtvqSMN++0aYeZdzbAGIGRou54D3Ij8Zr3c2gPrAFeCda0ZVkfsUIShyKnbdbdbWk4/k/awBWwAN+QvVjLhu97Syp8k2SpsZvgqAtT80TNwl3RTKRSR0pn7YDk/E+xOHFgjfC0VoDeafDvAaNcEwXJ+TjimTvhTHPgLi/0D4J9yA7tcNpEAAAAASUVORK5CYII="}}